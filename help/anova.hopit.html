<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Likelihood Ratio Test Tables</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/languages/r.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for anova.hopit {hopit}"><tr><td>anova.hopit {hopit}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Likelihood Ratio Test Tables</h2>

<h3>Description</h3>

<p>Compute likelihood ratio test for two or more <code>hopit</code> objecs.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'hopit'
anova(object, ..., method = c("sequential", "with.most.complex", 'with.least.complex'),
direction = c("decreasing", "increasing"))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>an object containing the results returned by a <code>hopit</code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>additional objects of the same type.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>the method of model comparison. Choose <code>"sequential"</code> for 1-2, 2-3, 3-4, ... comparisons or
<code>"with.most.complex"</code> for 1-2, 1-3, 1-4, ... comparisons, where 1 is the most complex model.</p>
</td></tr>
<tr valign="top"><td><code>direction</code></td>
<td>
<p>determine if complexity of listed models is <code>"increasing"</code> or <code>"decreasing"</code> (default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector or a matrix with results of the test(s).
</p>


<h3>Author(s)</h3>

<p>Maciej J. Danko
</p>


<h3>See Also</h3>

<p><code><a href="print.anova.hopit.html">print.anova.hopit</a></code>, <code><a href="print.lrt.hopit.html">print.lrt.hopit</a></code>, <code><a href="lrt.hopit.html">lrt.hopit</a></code>, <code><a href="hopit.html">hopit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class="r"># DATA
data(healthsurvey)

# the order of response levels is decreasing (from the best health to the worst health)
levels(healthsurvey$health)
</code></pre>

<pre><code>## [1] &quot;Excellent&quot; &quot;Very good&quot; &quot;Good&quot;      &quot;Fair&quot;      &quot;Poor&quot;
</code></pre>

<pre><code class="r"># Example 1 ---------------------

# fitting two nested models
model1 &lt;- hopit(latent.formula = health ~ hypertension + high_cholesterol +
                heart_attack_or_stroke + poor_mobility + very_poor_grip +
                depression + respiratory_problems +
                IADL_problems + obese + diabetes + other_diseases,
              thresh.formula = ~ sex + ageclass + country,
              decreasing.levels = TRUE,
              control = list(trace = FALSE),
              data = healthsurvey)

# model with interaction between hypertension and high_cholesterol
model2 &lt;- hopit(latent.formula = health ~ hypertension * high_cholesterol +
                heart_attack_or_stroke + poor_mobility + very_poor_grip +
                depression + respiratory_problems +
                IADL_problems + obese + diabetes + other_diseases,
              thresh.formula = ~ sex + ageclass + country,
              decreasing.levels = TRUE,
              control = list(trace = FALSE),
              data = healthsurvey)

# Likelihood ratio test
lrt1 &lt;- anova(model1, model2)
lrt1
</code></pre>

<pre><code>## Full model:
## -- Formula (latent variables): 
## health ~ hypertension + high_cholesterol + heart_attack_or_stroke +  
##     poor_mobility + very_poor_grip + depression + respiratory_problems +  
##     IADL_problems + obese + diabetes + other_diseases + hypertension:high_cholesterol
## -- Formula (threshold variables): ~sex + ageclass + country
## -- Theta: FALSE
## 
## Nested model:
## -- Formula (latent variables): 
## health ~ hypertension + high_cholesterol + heart_attack_or_stroke +  
##     poor_mobility + very_poor_grip + depression + respiratory_problems +  
##     IADL_problems + obese + diabetes + other_diseases
## -- Formula (threshold variables): ~sex + ageclass + country
## -- Theta: FALSE
## 
## Likelihood ratio test:
##  Chi^2 df Pr(&gt;Chi^2)
##   2.55  1       0.11
</code></pre>

<pre><code class="r"># print results in shorter form
print(lrt1, short = TRUE)
</code></pre>

<pre><code>## 
## Likelihood ratio test:
##  Chi^2 df Pr(&gt;Chi^2)
##   2.55  1       0.11
</code></pre>

<pre><code class="r"># equivalently
lrt.hopit(model2, model1)
</code></pre>

<pre><code>## Full model:
## -- Formula (latent variables): 
## health ~ hypertension + high_cholesterol + heart_attack_or_stroke +  
##     poor_mobility + very_poor_grip + depression + respiratory_problems +  
##     IADL_problems + obese + diabetes + other_diseases + hypertension:high_cholesterol
## -- Formula (threshold variables): ~sex + ageclass + country
## -- Theta: FALSE
## 
## Nested model:
## -- Formula (latent variables): 
## health ~ hypertension + high_cholesterol + heart_attack_or_stroke +  
##     poor_mobility + very_poor_grip + depression + respiratory_problems +  
##     IADL_problems + obese + diabetes + other_diseases
## -- Formula (threshold variables): ~sex + ageclass + country
## -- Theta: FALSE
## 
## Likelihood ratio test:
##  Chi^2 df Pr(&gt;Chi^2)
##   2.55  1       0.11
</code></pre>

<pre><code class="r"># Example 2 ---------------------

# fitting additional nested models
model3 &lt;- hopit(latent.formula = health ~ hypertension * high_cholesterol +
                heart_attack_or_stroke + poor_mobility + very_poor_grip +
                depression + respiratory_problems +
                IADL_problems + obese * diabetes + other_diseases,
              thresh.formula = ~ sex + ageclass + country,
              decreasing.levels = TRUE,
              control = list(trace = FALSE),
              data = healthsurvey)

model4 &lt;- hopit(latent.formula = health ~ hypertension * high_cholesterol +
                heart_attack_or_stroke + poor_mobility + very_poor_grip +
                depression + respiratory_problems +
                IADL_problems + obese * diabetes + other_diseases,
              thresh.formula = ~ sex * ageclass + country,
              decreasing.levels = TRUE,
              control = list(trace = FALSE),
              data = healthsurvey)

# sequential likelihood ratio tests
# model complexity increases so direction = &quot;increasing&quot;
anova(model1, model2, model3, model4,
      direction = &quot;increasing&quot;, method = &quot;sequential&quot;)
</code></pre>

<pre><code>## Anova (LRTs):
## Method: &quot;sequential&quot;
## 
##                   Chi^2.full df Pr(&gt;Chi^2).full   
## model2 vs. model1      2.550  1         0.11030   
## model3 vs. model2      0.509  1         0.47568   
## model4 vs. model3     26.427 12         0.00934 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

<pre><code class="r"># likelihood ratio tests of the most complex model with the rest
anova(model1, model2, model3, model4,
      direction = &quot;increasing&quot;, method = &quot;with.most.complex&quot;)
</code></pre>

<pre><code>## Anova (LRTs):
## Method: &quot;with.most.complex&quot;
## 
##                   Chi^2.full df Pr(&gt;Chi^2).full   
## model4 vs. model1     29.485 14         0.00898 **
## model4 vs. model2     26.935 13         0.01270 * 
## model4 vs. model3     26.427 12         0.00934 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>

<pre><code class="r"># likelihood ratio tests of the least complex model with the rest
anova(model1, model2, model3, model4,
      direction = &quot;increasing&quot;, method = &quot;with.least.complex&quot;)
</code></pre>

<pre><code>## Anova (LRTs):
## Method: &quot;with.least.complex&quot;
## 
##                   Chi^2.full df Pr(&gt;Chi^2).full   
## model2 vs. model1      2.550  1         0.11030   
## model3 vs. model1      3.059  2         0.21669   
## model4 vs. model1     29.485 14         0.00898 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
</code></pre>


<hr /><div style="text-align: center;">[Package <em>hopit</em> version 0.4.167 <a href="00Index.html">Index</a>]</div>
</body></html>
